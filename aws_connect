import boto3

session = boto3.Session(
    aws_access_key_id='your_access_key_id',
    aws_secret_access_key='your_secret_access_key',
    endpoint_url='https://your-vpc-endpoint-url.s3.amazonaws.com'
)

s3 = session.client('s3')

# List objects in the bucket
file_names = list()
response = s3.list_objects(Bucket='my-bucket',Prefix='prefix')
for obj in response['Contents']:
    print(obj['Key'])
    file_names.append(obj['Key'])

# Download a file from the bucket
s3.download_file('my-bucket', 'remote_file.txt', 'local_file.txt')
